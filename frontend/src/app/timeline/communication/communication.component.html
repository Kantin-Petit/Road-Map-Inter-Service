<div *ngFor="let service of servicesFilter | keyvalue">

  <div>
    <input type="checkbox" [(ngModel)]="checkedServices[selectedForService(service)]" (ngModelChange)="isAllChecked()"/>
    <label>{{ service.key }}</label>
  </div>

  <div *ngIf="service.value.sujets">
    <div *ngFor="let sujet of service.value.sujets">
      <input type="checkbox" [ngModel]="isChecked(service.key, sujet)" (ngModelChange)="onSelectSubjects(service.key, $event, sujet)"> 
      <label>{{ sujet }}</label>
    </div>
  </div>

</div>

<div class="timeline_wrapper">

  <ng-container *ngFor="let service of services | keyvalue">
  <section class="timeline">
    <div class="info">
      <img width="50" height="50" src="https://assets.codepen.io/210284/face.svg" alt=""/>
      <h2>{{service.key | uppercase }}</h2>
      <p>{{ service.value.description }}</p>
    </div>
    <ol>
      <li *ngFor="let timeline of service.value.timelines; let i = index">
        <div  [class.card_selected]="sidebarVisible && selectedItemIndex === service.key[i]" (click)="toggleSidebar(i, service.key, timeline.titre, timeline.texte)" [style.background-color]="getColorForSubject(timeline.sujet)">
          <time>{{ timeline.titre }}</time>
          <ng-container *ngIf="timeline.texte && isSingleText(timeline.texte)">
            <p *ngFor="let texte of timeline.texte">- {{ texte }}</p>
          </ng-container>
          <p *ngIf="timeline.texte && !isSingleText(timeline.texte)">{{ timeline.texte }}</p>
        </div>
      </li>
    </ol>
    <p-sidebar [(visible)]="sidebarVisible" position="right">
      <h3>{{sidebarData.title}}</h3>
      <ng-container *ngIf="sidebarData.text && isSingleText(sidebarData.text)">
        <p *ngFor="let texte of sidebarData.text">- {{ texte }}</p>
      </ng-container>
      <p *ngIf="sidebarData.text && !isSingleText(sidebarData.text)">{{ sidebarData.text }}</p>
    </p-sidebar>
  </section>
  </ng-container>
</div>
