<ng-container *ngFor="let service of servicesFilter | keyvalue">

  <div class="service_name">
    <input name="input_{{service.key}}" id="input_{{service.key}}" type="checkbox" [(ngModel)]="checkedServices[selectedForService(service)]" (ngModelChange)="isAllChecked()"/>
    <label for="input_{{service.key}}">{{ service.key }}</label>
  </div>

  <div class="subject_name" *ngIf="service.value.sujets">
    <div *ngFor="let sujet of service.value.sujets">
      <input name="input_{{service.key}}_{{sujet}}" id="input_{{service.key}}_{{sujet}}" type="checkbox" [ngModel]="isChecked(service.key, sujet)" (ngModelChange)="onSelectSubjects(service.key, $event, sujet)"> 
      <label for="input_{{service.key}}_{{sujet}}">{{ sujet }}</label>
    </div>
  </div>

</ng-container>

<div class="timeline_wrapper">

  <ng-container *ngFor="let service of services | keyvalue">
  <section class="timeline">
    <div class="info">
      <img width="50" height="50" src="https://assets.codepen.io/210284/face.svg" alt=""/>
      <h2>{{service.key | uppercase }}</h2>
      <p>{{ service.value.description }}</p>
    </div>
    <ol>
      <li *ngFor="let timeline of service.value.timelines; let i = index">
        <div  [class.card_selected]="sidebarVisible && selectedItemIndex === service.key[i]" (click)="toggleSidebar(i, service.key, timeline)" [style.background-color]="getColorForSubject(timeline.sujet)">
          <app-sidebar *ngIf="timeline" [sidebarData]="timeline"></app-sidebar>
        </div>
      </li>
    </ol>
  </section>
  </ng-container>

  <p-sidebar [(visible)]="sidebarVisible" position="right">
    <app-sidebar *ngIf="sidebarData" [sidebarData]="sidebarData"></app-sidebar>
  </p-sidebar>

</div>